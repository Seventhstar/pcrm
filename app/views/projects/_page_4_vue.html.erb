<script>
  Vue.component('v-select', VueSelect.VueSelect)

  let app = new Vue({
    el: '.vue_app',
    data: <%= fill_vue_data(@project,
     {
      orderAmount: {},
      offerAmount: {},
      oa: [],
      currencies: [1,2,3],
      f_gt: true,
      texts: "gtype new_gtype",
      lists: "gtypes new_gtypes",
      project_g_types: [],
      totalAmount: [],
      goods: @goods
     }) %>,
    computed: {
      
    },
    methods:{
      fOfferAmount(gt){
          this.offerAmount[gt] = {}
          this.currencies.forEach( (c) => this.offerAmount[gt][c] = 0 )
          for (var gi in this.goods[gt]){
              g = this.goods[gt][gi]
              c = g.currency_id
              console.log("g.gsum", g.gsum)
              this.offerAmount[gt][c] = this.offerAmount[gt][c] + g.gsum
              // console.log("g", gt[g].currency_id)
          }
        return this.offerAmount[gt]
      },
      g_href(g){
        return "/project_goods/" + g.id + "/edit"
      },
      g_del_ref(g){
        return "/project_goods/" + g.id 
      },
      add_gt(){
        if (this.new_gtype!==null){
          this.goods[this.new_gtype.value] = []
          this.gtypes.push(this.new_gtype)
          this.new_gtypes.splice(this.new_gtypes.indexOf(this.new_gtype),1)          
          this.new_gtype = null 
        }
      }
    }
    })

</script>