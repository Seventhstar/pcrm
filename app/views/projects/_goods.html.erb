<table class="tleads twfixed" id="project_goods<%= pgt.id %>"  model="ProjectGood" action="project_goods" color_cls="ordered">
  <% opened = local_assigns.has_key?(:opened) ? opened : false %>   
  <thead class="<%= @goods.count>0 || opened ? '' : 'hidden' %>">
    <%= render partial: 'project_goods/head_row' %>
  </thead>

  <tbody>
    <% @goods.order(:id).each do |g| %>
      <%= render partial: "project_goods/good", locals: {g: g} %>
    <% end %>
      <tr id="new_pgt_item<%= pgt.id %>" class="<%= opened ? '' : 'invisible' %> editable new_row">
        <% iname = ['project_good_',pgt.id,'_'].join %>
        <%= hidden_field iname,'goodstype_id', value: pgt.id %>
        <td class="fw" width='220px'><%= text_field iname,:name, {:class => 'txt'} %></td>
        <td width='216px'>
        <% gt_coll = Goodstype.find_by(id: pgt.id) %>
        <% if !gt_coll.nil? %>
          <%= chosen_src "provider_id", gt_coll.providers, nil,{nil_value: 'Выберите поставщика...',add_name: iname} %></td>
        <% end %>
        <td class="caption3" width='115px'><%= text_field iname,:date_place, { value: Date.today.try('strftime',"%d.%m.%Y") , :class => 'txt datepicker'} %></td>
        <td class="caption3" width='230px'><%= text_field iname,:description, {:class => 'txt fullwidth'} %></td>

        <td width='58px'><%= chosen_src "currency_id", currency_src,1,{nil_value: '',add_name: iname, add_class: 'currency_src'} %></td>
        <%= td_sum_field(iname, :gsum, '', {width: '90px'}) %>

        <td width="48px"><span class="sub btn_a" id="btn-sub-send" pe_id="<%= pgt.id %>" action='/project_goods/' prm='project_good_<%= pgt.id %>_'>Сохр.</span></td>
      </tr>
      <%= render partial: 'project_goods/total', locals: {opened: opened, total: total} %>
  </tbody>
</table>