<script>

  Vue.component('v-select', VueSelect.VueSelect)
  
  let ptype = new Vue({
  el: '#costing_app',
  data: <%= fill_vue_data(@costing,
    { 
      model: 'costing',
      room_works: @room_works,
      texts: 'room work',
      lists: 'rooms works costings_types',
      works: [],
      tabs: [],

    })%>,

  methods: {
    v_nil(v){
      return v_nil(v);
    },
    
    addRoom(){
      if (v_nil(this.room)){
        show_ajax_message('Выберите помещение', 'error');
        return;
      }
      this.tabs.push({label: this.room.label, active: this.tabs.length === 0 ? true : false})
      this.rooms.splice(this.rooms.indexOf(this.room), 1)
      this.room = null
    },

    addWork(){
      if (v_nil(this.work)){
        show_ajax_message('Выберите помещение', 'error');
        return;
      }
      this.tabs.push({label: this.room.label, active: this.tabs.length === 0 ? true : false})
      this.rooms.splice(this.rooms.indexOf(this.room), 1)
      this.room = null
    },
    
    setActive(tab) {
      this.tabs.forEach(el => {
        el.active = el === tab;
      })
    }
  },

  computed: {
    currentTab: function () {
      console.log();
      return this.tabs.reduce((accum, curr) => {return curr.active ? curr : accum}, {});
    }
  }
});
  

</script>