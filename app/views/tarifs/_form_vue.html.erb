<script>
  Vue.component('v-select', VueSelect.VueSelect)

  let app = new Vue({
    el: '.vue_app',
    data: <%= fill_vue_data(@tarif, {
      model: 'tarif',
      noteValid: '',
      formValid: false,
      texts: 'sum sum2 from dis_price dis_price2 vis_price',
      labelSum: '',
      list_values: 'project_type tarif_calc_type',
      lists: "project_types tarif_calc_types"
    })%>,
    
    updated(){
      this.onInput();
    },

    mounted(){
      this.$root.$on('onInput', this.onInput);
    },

    created(){
      this.formatLabelSum();
    },

    computed: {


    },

    methods: {

      formatLabelSum(){
        console.log(this.tarif_calc_type)
        if (this.tarif_calc_type.value == 1) {this.labelSum = "Цена за м2:"; return; }
        this.labelSum = "Цена/Сумма:"
      },

      onInput(e){
        let formValid = true;
        // console.log(e)
        if (e !==undefined && e.name == 'tarif_calc_type'){this.formatLabelSum()}
        this.formValid = formValid;
        // this.f_shop = f_shop;
      },

      onSubmit(event){
        if (event && !this.formValid) {
          event.preventDefault();
          show_ajax_message(this.noteValid, 'error');
        }

      },

      equals(obj, v){      
        if (obj===null) {return false;} 
        if (v.constructor === Array) return v.includes(obj.value);
        return obj.value === v; 
      }
    }
  });

</script>