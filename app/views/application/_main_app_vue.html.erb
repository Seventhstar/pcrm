<script>
  Vue.component('v-select', VueSelect.VueSelect)
  // Vue.component('vue2-storage', Vue2Storage.Vue2Storage)
  // import {} from ''



  let nav = new Vue({
    el: '.nav_select',
    data: <%= fill_vue_data(nil, {
      texts: 'search',
      list_values: 'year city',
      mainFilters: ['search'],
      lists: 'years cities',
      params: @params
    }, 'app') %>,
    
    mounted() {
      console.log('mounted params', this.params)

    },

    created() {
      console.log('params', this.params)
      this.search = this.params.search
      // this.mainFilters.forEach( f => {this[f] = this.params[f]})
    },

    watch: {
      year(newValue) {  
        // sortable_prepare({});
        $(".main_data_table").html()
        // delay('document.location.reload(true)', 400)
        delay('sortable_query({})', 700)
      },

      city(newValue) {
        sortable_prepare({});
        $.ajax({
          type: "POST",
          url: "/ajax/set_city",
          data: {city: this.city.value},
          dataType: "json",
          encode: true
        })
        // delay('document.location.reload(true)', 400)
      }
    },

    methods: {
      searchChange(newValue) {
        // delay('sortable_query({})', 700)
      },

      clearSearch() {
        this.search = ''
        delay('sortable_query({})', 700)
      }
     }
    
  })
</script>